# Быстрое исправление миграций отзывов товаров

## Проблема

Миграция не применилась из-за попытки добавить индексы к несуществующей таблице.

## Решение

### 1. Используйте исправленный скрипт миграций

Вместо `apply-product-reviews-migration.php` используйте:

```
https://ваш-сайт.ru/apply-product-reviews-migration-fixed.php
```

### 2. Проверьте созданные таблицы

После применения миграций проверьте:

```
https://ваш-сайт.ru/check-product-reviews-tables.php
```

## Что исправлено

1. **Убраны отдельные ALTER TABLE запросы** - все индексы теперь включены в CREATE TABLE
2. **Добавлена таблица telegram_users** - которая отсутствовала
3. **Улучшена обработка ошибок** - скрипт пропускает уже существующие таблицы
4. **Добавлена проверка существования** - перед созданием таблиц и представлений

## Ожидаемый результат

После успешного применения миграций должны быть созданы:

- ✅ `telegram_users` - пользователи Telegram
- ✅ `product_reviews` - отзывы товаров
- ✅ `product_review_likes` - лайки отзывов
- ✅ `product_review_reports` - жалобы на отзывы
- ✅ `product_reviews_stats` - представление для статистики

## Следующие шаги

1. Примените исправленные миграции
2. Проверьте созданные таблицы
3. Протестируйте функциональность на странице товара
4. Проверьте модерацию в админке

## Файлы для загрузки

Убедитесь, что загружены исправленные файлы:

- `database/product-reviews-migration.sql` (исправленный)
- `apply-product-reviews-migration-fixed.php` (новый)
- `check-product-reviews-tables.php` (новый)
