# üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞:**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è CSRF —Ç–æ–∫–µ–Ω–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –æ—à–∏–±–∫–∞ **"Invalid action."** –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ "–û–¥–æ–±—Ä–∏—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å". –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è.

## üìä **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**

### ‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- POST –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Action: "approve" –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- Review ID: "13" –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- CSRF Token –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### ‚ùå **–ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- –§—É–Ω–∫—Ü–∏—è `handleReviewAction` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ "approve"
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ "Invalid action."

## üîß **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞:**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω `test-review-action.php`** ‚úÖ

- –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∂–µ—Ç, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ–π

### 2. **–†–∞—Å—à–∏—Ä–µ–Ω–∞ –æ—Ç–ª–∞–¥–∫–∞ –≤ `admin/reviews.php`** ‚úÖ

- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ —Ñ–∞–π–ª –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `handleReviewAction`
- –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏

### 3. **–†–∞—Å—à–∏—Ä–µ–Ω–∞ –æ—Ç–ª–∞–¥–∫–∞ –≤ `admin-functions.php`** ‚úÖ

- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ —Ñ–∞–π–ª –≤—Å–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã action –∏ review_id
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- –õ–æ–≥–∏—Ä—É–µ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### **–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç**

–û—Ç–∫—Ä–æ–π—Ç–µ: `https://cherkas-therapy.ru/test-review-action.php`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

- ‚úÖ –§–∞–π–ª Database.php –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –§–∞–π–ª admin-functions.php –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –§—É–Ω–∫—Ü–∏—è handleReviewAction —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ
- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏

### **–®–∞–≥ 2: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–û–¥–æ–±—Ä–∏—Ç—å"**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É: `https://cherkas-therapy.ru/admin/reviews.php`
2. –ù–∞–π–¥–∏—Ç–µ –æ—Ç–∑—ã–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç"
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–û–î–û–ë–†–ò–¢–¨"**
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ

### **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–æ–≥–∏**

–û—Ç–∫—Ä–æ–π—Ç–µ: `https://cherkas-therapy.ru/debug-reviews.php`

**–û–∂–∏–¥–∞–µ–º—ã–µ –∑–∞–ø–∏—Å–∏:**

```
[2025-09-16 18:05:22] POST request received. Action: approve, Data: {...}
[2025-09-16 18:05:22] CSRF token verified, calling handleReviewAction
[2025-09-16 18:05:22] Function exists: YES
[2025-09-16 18:05:22] handleReviewAction called with data: {...}
[2025-09-16 18:05:22] Action: 'approve', Review ID: '13'
[2025-09-16 18:05:22] Processing action: 'approve'
[2025-09-16 18:05:22] handleReviewAction result: {...}
```

## üéØ **–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

### ‚úÖ **–ï—Å–ª–∏ –≤—Å–µ –ª–æ–≥–∏ –µ—Å—Ç—å:**

- –§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏

### ‚ùå **–ï—Å–ª–∏ "Function exists: NO":**

- –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞ `admin-functions.php`
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º

### ‚ùå **–ï—Å–ª–∏ "Unknown action: 'approve'":**

- –ü—Ä–æ–±–ª–µ–º–∞ —Å switch statement
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ case 'approve'

### ‚ùå **–ï—Å–ª–∏ –ª–æ–≥–∏ –æ–±—Ä—ã–≤–∞—é—Ç—Å—è:**

- –û—à–∏–±–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `handleReviewAction`
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üìã **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ `test-review-action.php`** - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
2. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û–¥–æ–±—Ä–∏—Ç—å"** –≤ –∞–¥–º–∏–Ω–∫–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `debug-reviews.php`** - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –∫–∞–∫–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ –ª–æ–≥–∞—Ö

## üéâ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

–ü–æ—Å–ª–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –º—ã —Å–º–æ–∂–µ–º —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:

- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `handleReviewAction`
- ‚úÖ –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ "approve"
- ‚úÖ –ì–¥–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ–π

## üìù **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π `test-review-action.php`**
2. **–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û–¥–æ–±—Ä–∏—Ç—å"** –≤ –∞–¥–º–∏–Ω–∫–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–æ–≥–∏** –≤ `debug-reviews.php`
4. **–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –∫–∞–∫–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ—è–≤–∏–ª–∏—Å—å

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏.** üîç
