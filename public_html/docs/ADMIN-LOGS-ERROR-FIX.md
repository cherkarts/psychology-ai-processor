# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π admin_logs

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!**

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `SQLSTATE[42S02]: Base table or view not found: 1146 Table 'cherk146_charkas-therapy.admin_logs' doesn't exist`, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –ø—Ä–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ.

## üîç **–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –æ—Ç–∑—ã–≤—É –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

```
–û—à–∏–±–∫–∞: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'cherk146_charkas-therapy.admin_logs' doesn't exist
```

–û—à–∏–±–∫–∞ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–≤—Å–µ —Ä–∞–±–æ—Ç–∞–ª–æ), –Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

## üîß **–†–µ—à–µ–Ω–∏–µ:**

### 1. **–û–±–µ—Ä–Ω—É–ª –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ try-catch –±–ª–æ–∫–∏** ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É `admin_logs`
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞:

```php
// –õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
try {
  $logSql = "
        INSERT INTO admin_logs (
            admin_user, action, target_type, target_id, details, created_at
        ) VALUES (
            :admin_user, :action, :target_type, :target_id, :details, NOW()
        )
    ";

  $logStmt = $pdo->prepare($logSql);
  $logStmt->bindValue(':admin_user', $_SESSION['admin_user']['username'], PDO::PARAM_STR);
  $logStmt->bindValue(':action', 'delete_review', PDO::PARAM_STR);
  $logStmt->bindValue(':target_type', 'product_review', PDO::PARAM_STR);
  $logStmt->bindValue(':target_id', $reviewId, PDO::PARAM_INT);
  $logStmt->bindValue(':details', json_encode([
    'comment' => $comment
  ]), PDO::PARAM_STR);
  $logStmt->execute();
} catch (Exception $logError) {
  // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  error_log("Admin logs table not found, skipping log entry: " . $logError->getMessage());
}
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–∞:

```php
// –õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
try {
  $logSql = "
        INSERT INTO admin_logs (
            admin_user, action, target_type, target_id, details, created_at
        ) VALUES (
            :admin_user, :action, :target_type, :target_id, :details, NOW()
        )
    ";

  $logStmt = $pdo->prepare($logSql);
  $logStmt->bindValue(':admin_user', $_SESSION['admin_user']['username'], PDO::PARAM_STR);
  $logStmt->bindValue(':action', "moderate_review_{$action}", PDO::PARAM_STR);
  $logStmt->bindValue(':target_type', 'product_review', PDO::PARAM_STR);
  $logStmt->bindValue(':target_id', $reviewId, PDO::PARAM_INT);
  $logStmt->bindValue(':details', json_encode([
    'action' => $action,
    'comment' => $comment
  ]), PDO::PARAM_STR);
  $logStmt->execute();
} catch (Exception $logError) {
  // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  error_log("Admin logs table not found, skipping log entry: " . $logError->getMessage());
}
```

## üéØ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:

1. **–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∏:** –ö–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É `admin_logs`
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏:** –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ—à–∏–±–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏:** –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ error_log –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

- ‚úÖ **–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç** –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç** –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–û—à–∏–±–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üìÅ **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:**

- **`admin/api/moderate-product-review.php`** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### 1. **–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–∞:**

- –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É ‚Üí –û—Ç–∑—ã–≤—ã —Ç–æ–≤–∞—Ä–æ–≤
- –ù–∞–∂–º–∏—Ç–µ "–û–î–û–ë–†–ò–¢–¨" –∏–ª–∏ "–û–¢–ö–õ–û–ù–ò–¢–¨" –Ω–∞ –ª—é–±–æ–º –æ—Ç–∑—ã–≤–µ
- –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
- –û—à–∏–±–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–ª—è—Ç—å—Å—è

### 2. **–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞:**

- –ù–∞–∂–º–∏—Ç–µ "–£–î–ê–õ–ò–¢–¨" –Ω–∞ –ª—é–±–æ–º –æ—Ç–∑—ã–≤–µ
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ
- –û—à–∏–±–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–ª—è—Ç—å—Å—è

## ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –û—à–∏–±–∫–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π `admin_logs` –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üö® **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:**

1. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞:** Ctrl+F5
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:** –û—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ error_log
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:** –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å JavaScript –æ—à–∏–±–æ–∫

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–µ–ø–µ—Ä—å –º–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫! –û—à–∏–±–∫–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π `admin_logs` –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** üåü
