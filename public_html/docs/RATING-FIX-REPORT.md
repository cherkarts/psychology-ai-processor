# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º –æ—Ç–∑—ã–≤–æ–≤

## üîç **–ü—Ä–æ–±–ª–µ–º–∞**

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∏—Ç 5 –∑–≤–µ–∑–¥, –Ω–æ –≤ –æ—Ç–∑—ã–≤–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 –∑–≤–µ–∑–¥–∞.

## üõ†Ô∏è **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ JavaScript**

**–ü—Ä–æ–±–ª–µ–º–∞:** `rating.value` –≤–æ–∑–≤—Ä–∞—â–∞–ª —Å—Ç—Ä–æ–∫—É, –∞ –Ω–µ —á–∏—Å–ª–æ
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —á–∏—Å–ª–æ

#### –í –≤–∏–¥–∂–µ—Ç–µ (`includes/product-reviews-widget.php`):

```javascript
// –ë—ã–ª–æ:
rating: rating.value,

// –°—Ç–∞–ª–æ:
const ratingValue = parseInt(rating.value);
rating: ratingValue,
```

### 2. **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ API**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –±—ã–ª–æ –≤–∏–¥–Ω–æ, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ API
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –í API (`api/product-reviews.php`):

```php
// –õ–æ–≥–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
error_log("Product review API - Received data: " . json_encode([
  'product_id' => $productId,
  'rating_raw' => $input['rating'] ?? 'not_set',
  'rating_parsed' => $rating,
  'text_length' => strlen($text)
]));

// –õ–æ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
error_log("Product review API - Saving to database: " . json_encode([
  'product_id' => $productId,
  'telegram_user_id' => $telegramUser['id'],
  'rating' => $rating,
  'text_length' => strlen($text)
]));
```

### 3. **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ –°–æ–∑–¥–∞–Ω `test-rating-fix.php` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### 1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:**

```
https://–≤–∞—à-—Å–∞–π—Ç.ru/test-rating-fix.php
```

### 2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**

- –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã `product_reviews`
- –¢–∏–ø –ø–æ–ª—è `rating` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `tinyint(3)` –∏–ª–∏ `int(11)`)
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã –∏ –∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–∏
- –¢–µ—Å—Ç –≤—Å—Ç–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–∞ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 5

### 3. **–ï—Å–ª–∏ –ø–æ–ª–µ rating –∏–º–µ–µ—Ç —Ç–∏–ø `tinyint(1)`:**

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∫–æ–º–∞–Ω–¥—É:

```sql
ALTER TABLE product_reviews MODIFY COLUMN rating TINYINT(3) NOT NULL COMMENT '–û—Ü–µ–Ω–∫–∞ –æ—Ç 1 –¥–æ 5';
```

## üìã **–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ**

1. **`includes/product-reviews-widget.php`** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞
2. **`api/product-reviews.php`** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **`test-rating-fix.php`** - –Ω–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**

### 1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**

- –û—Ç–∫—Ä–æ–π—Ç–µ F12 –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–∑—ã–≤–∞
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–∑—ã–≤–∞: { productId: "...", rating: 5, text: "..." }`

### 2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**

- –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø–∏—Å–∏ `Product review API - Received data`
- –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø–∏—Å–∏ `Product review API - Saving to database`

### 3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**

- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `test-rating-fix.php`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø –ø–æ–ª—è `rating`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã

## ‚ö†Ô∏è **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã**

### 1. **–¢–∏–ø –ø–æ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**

- `tinyint(1)` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ 0-1
- `tinyint(3)` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è 0-255 ‚úÖ
- `int(11)` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª—é–±—ã–µ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ ‚úÖ

### 2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –ë—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é JavaScript
- –ù–∞–∂–º–∏—Ç–µ Ctrl+F5 –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 3. **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–æ–π:**

- Radio buttons –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã–±—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥

## ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ 5 –∑–≤–µ–∑–¥ –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –∫–∞–∫ 5
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –æ—Ç–∑—ã–≤–∞—Ö
- ‚úÖ –õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –¢–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ

## üö® **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:** `test-rating-fix.php`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø –ø–æ–ª—è:** –î–æ–ª–∂–µ–Ω –±—ã—Ç—å `tinyint(3)` –∏–ª–∏ –±–æ–ª—å—à–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:** –î–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
4. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à:** Ctrl+F5 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å:** –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–∞

–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ—à–µ–Ω–∞! üéØ
