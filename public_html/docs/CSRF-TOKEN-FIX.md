# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å CSRF —Ç–æ–∫–µ–Ω–æ–º –≤ –∞–¥–º–∏–Ω–∫–µ –æ—Ç–∑—ã–≤–æ–≤

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!**

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–Ω–æ–ø–æ–∫ "–û–¥–æ–±—Ä–∏—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" –≤ –∞–¥–º–∏–Ω–∫–µ –æ—Ç–∑—ã–≤–æ–≤.

## üîç **–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ "–û–¥–æ–±—Ä–∏—Ç—å" –∏–ª–∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" –≤ –∞–¥–º–∏–Ω–∫–µ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞ **"–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏."** –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ CSRF —Ç–æ–∫–µ–Ω–∞.

## üîß **–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏—è `generateCSRFToken`** –≤ —Ñ–∞–π–ª–µ `admin/reviews.php`
2. **`window.adminCSRFToken` –±—ã–ª –ø—É—Å—Ç—ã–º** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –∫–∞–∫ `''` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
3. **JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–∫–∞–ª–∏ —Ç–æ–∫–µ–Ω –≤ meta —Ç–µ–≥–∞—Ö** –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `window.adminCSRFToken`

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

### 1. **–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ CSRF** ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ CSRF —Ç–æ–∫–µ–Ω–æ–≤
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ `admin/reviews.php`

```php
// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ CSRF —Ç–æ–∫–µ–Ω–æ–≤
if (!function_exists('generateCSRFToken')) {
    function generateCSRFToken()
    {
        if (!isset($_SESSION['csrf_token'])) {
            $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
        }
        return $_SESSION['csrf_token'];
    }
}

if (!function_exists('verifyCSRFToken')) {
    function verifyCSRFToken($token)
    {
        return isset($_SESSION['csrf_token']) && hash_equals($_SESSION['csrf_token'], $token);
    }
}
```

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞** ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** `window.adminCSRFToken` –±—ã–ª –ø—É—Å—Ç—ã–º
**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–∑ PHP

```javascript
// –ë—ã–ª–æ:
window.adminCSRFToken = window.adminCSRFToken || ''

// –°—Ç–∞–ª–æ:
window.adminCSRFToken = '<?php echo generateCSRFToken(); ?>'
```

### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã JavaScript —Ñ—É–Ω–∫—Ü–∏–∏** ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏–∏ –∏—Å–∫–∞–ª–∏ —Ç–æ–∫–µ–Ω –≤ meta —Ç–µ–≥–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `window.adminCSRFToken`

```javascript
// –ë—ã–ª–æ:
csrfInput.value =
  document.querySelector('meta[name="csrf-token"]')?.getAttribute('content') ||
  ''

// –°—Ç–∞–ª–æ:
csrfInput.value = window.adminCSRFToken || ''
```

## üéØ **–ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:**

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞:

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π CSRF —Ç–æ–∫–µ–Ω
2. **–¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–µ—Å—Å–∏–∏** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
3. **–¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ JavaScript** —á–µ—Ä–µ–∑ `window.adminCSRFToken`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞:

1. **–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã** —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ POST –∑–∞–ø—Ä–æ—Å–µ
2. **PHP –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω** —á–µ—Ä–µ–∑ `verifyCSRFToken()`
3. **–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π** - –¥–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
4. **–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω** –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç CSRF –∞—Ç–∞–∫** —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ `hash_equals()`

## üìÅ **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**

1. **`admin/reviews.php`** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ CSRF –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### 1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–∫–∏:**

- –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É ‚Üí –û—Ç–∑—ã–≤—ã
- –ù–∞–π–¥–∏—Ç–µ –æ—Ç–∑—ã–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç"
- –ù–∞–∂–º–∏—Ç–µ "–û–¥–æ–±—Ä–∏—Ç—å" –∏–ª–∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å"
- **–û—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å** ‚úÖ

### 2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –ù–∞–∂–º–∏—Ç–µ "–û–¥–æ–±—Ä–∏—Ç—å" ‚Üí —Å—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ "–û–¥–æ–±—Ä–µ–Ω"
- –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" ‚Üí —Å—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ "–û—Ç–∫–ª–æ–Ω–µ–Ω"
- **–î–µ–π—Å—Ç–≤–∏—è –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫** ‚úÖ

### 3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

- –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏
- –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## ‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- ‚úÖ **–û—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" –∏—Å—á–µ–∑–ª–∞**
- ‚úÖ **–ö–Ω–æ–ø–∫–∏ "–û–¥–æ–±—Ä–∏—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
- ‚úÖ **CSRF –∑–∞—â–∏—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
- ‚úÖ **–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫**

## üö® **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:**

1. **–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞:** Ctrl+F5
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:** –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å JavaScript –æ—à–∏–±–æ–∫
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Å—Å–∏—é:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Å—Å–∏—è –∞–∫—Ç–∏–≤–Ω–∞
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ "–û–¥–æ–±—Ä–∏—Ç—å" –∏ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" –≤ –∞–¥–º–∏–Ω–∫–µ –æ—Ç–∑—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ CSRF —Ç–æ–∫–µ–Ω–∞! –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Å—Ç–∞–ª–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π.

**–ü—Ä–æ–±–ª–µ–º–∞ —Å CSRF —Ç–æ–∫–µ–Ω–æ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** üåü
