# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ

## ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞**

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤

–¢–µ–ø–µ—Ä—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –ª—é–±—ã–µ –æ—Ç–∑—ã–≤—ã —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ pending), –≤–∫–ª—é—á–∞—è:

- ‚úÖ –û–∂–∏–¥–∞—é—â–∏–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (pending)
- ‚úÖ –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ (approved)
- ‚úÖ –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ (rejected)

## üîß **–ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω API –º–æ–¥–µ—Ä–∞—Ü–∏–∏** (`admin/api/moderate-product-review.php`)

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ `delete`:

```php
if (!in_array($action, ['approved', 'rejected', 'delete'])) {
  throw new Exception('–ù–µ–≤–µ—Ä–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ');
}
```

#### –õ–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π:

```php
if ($action === 'delete') {
  // –£–¥–∞–ª—è–µ–º –æ—Ç–∑—ã–≤ (–≤–∫–ª—é—á–∞—è —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
  $pdo->beginTransaction();

  try {
    // –£–¥–∞–ª—è–µ–º –ª–∞–π–∫–∏ –æ—Ç–∑—ã–≤–∞
    $deleteLikesSql = "DELETE FROM product_review_likes WHERE review_id = :review_id";

    // –£–¥–∞–ª—è–µ–º –∂–∞–ª–æ–±—ã –Ω–∞ –æ—Ç–∑—ã–≤
    $deleteReportsSql = "DELETE FROM product_review_reports WHERE review_id = :review_id";

    // –£–¥–∞–ª—è–µ–º —Å–∞–º –æ—Ç–∑—ã–≤
    $deleteReviewSql = "DELETE FROM product_reviews WHERE id = :review_id";

    $pdo->commit();

    // –õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
    // ...

  } catch (Exception $e) {
    $pdo->rollBack();
    throw $e;
  }
}
```

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∫–∏** (`admin/product-reviews.php`)

#### –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:

```html
<button
  class="btn btn-warning btn-sm"
  onclick="deleteReview(<?= $review['id'] ?>)"
  title="–£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤"
>
  <i class="fas fa-trash"></i>
  –£–¥–∞–ª–∏—Ç—å
</button>
```

#### JavaScript —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è:

```javascript
async function deleteReview(reviewId) {
  if (
    !confirm(
      '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ—Ç–∑—ã–≤? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.'
    )
  ) {
    return
  }

  const comment = prompt('–ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):')

  try {
    const response = await fetch('api/moderate-product-review.php', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        review_id: reviewId,
        action: 'delete',
        comment: comment || '',
      }),
    })

    const result = await response.json()

    if (result.success) {
      showNotification('–û—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω', 'success')
      setTimeout(() => {
        window.location.reload()
      }, 1000)
    } else {
      showNotification('–û—à–∏–±–∫–∞: ' + result.error, 'error')
    }
  } catch (error) {
    console.error('Error:', error)
    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞', 'error')
  }
}
```

## üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**

### 1. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–∫–∞—Ç (rollback)
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### 2. **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**

- –£–¥–∞–ª—è—é—Ç—Å—è –ª–∞–π–∫–∏ –æ—Ç–∑—ã–≤–∞ (`product_review_likes`)
- –£–¥–∞–ª—è—é—Ç—Å—è –∂–∞–ª–æ–±—ã –Ω–∞ –æ—Ç–∑—ã–≤ (`product_review_reports`)
- –£–¥–∞–ª—è–µ—Ç—Å—è —Å–∞–º –æ—Ç–∑—ã–≤ (`product_reviews`)

### 3. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è**

- –î–≤–æ–π–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (confirm + prompt)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É —É–¥–∞–ª–µ–Ω–∏—è

### 4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `admin_logs`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –≤—ã–ø–æ–ª–Ω–∏–≤—à–∏–π –¥–µ–π—Å—Ç–≤–∏–µ

## üìã **–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ**

1. **`admin/api/moderate-product-review.php`** - API –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤
2. **`admin/product-reviews.php`** - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### 1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ:**

- –û—Ç–∫—Ä–æ–π—Ç–µ `https://–≤–∞—à-—Å–∞–π—Ç.ru/admin/product-reviews.php`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### 2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è:**

- –ù–∞–π–¥–∏—Ç–µ –ª—é–±–æ–π –æ—Ç–∑—ã–≤ –≤ —Å–ø–∏—Å–∫–µ
- –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –æ—Ä–∞–Ω–∂–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å" —Å –∏–∫–æ–Ω–∫–æ–π –∫–æ—Ä–∑–∏–Ω—ã

### 3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ:**

- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–£–¥–∞–ª–∏—Ç—å"
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –¥–∏–∞–ª–æ–≥–µ
- –£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É —É–¥–∞–ª–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –û—Ç–∑—ã–≤ –¥–æ–ª–∂–µ–Ω –∏—Å—á–µ–∑–Ω—É—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞

### 4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**

- –î–µ–π—Å—Ç–≤–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω–æ –≤ –ª–æ–≥–∏ –∞–¥–º–∏–Ω–∫–∏
- –ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

### –û–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å:

- **–£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ** - –æ—Ç–∑—ã–≤ –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –æ—Ç–∑—ã–≤, –∞ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:

- –§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —Å –ø—Ä–∞–≤–∞–º–∏ `reviews`
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤:

- ‚úÖ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–∑—ã–≤–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤! üöÄ
