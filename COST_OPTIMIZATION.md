# 💰 Оптимизация расходов на AI

## 📊 Сравнение стоимости моделей

### GPT-3.5-turbo (Рекомендуется)
- **Стоимость:** $0.0015 за 1K токенов (вход) / $0.002 за 1K токенов (выход)
- **Средняя статья:** ~$0.15-0.25
- **3 статьи в день:** ~$0.45-0.75
- **В месяц:** ~$13-23

### GPT-4 (Дорого)
- **Стоимость:** $0.03 за 1K токенов (вход) / $0.06 за 1K токенов (выход)
- **Средняя статья:** ~$3-5
- **3 статьи в день:** ~$9-15
- **В месяц:** ~$270-450

## 🎯 Стратегии экономии

### 1. Умный выбор модели
```bash
# В .env файле
WRITING_MODEL=gpt-3.5-turbo  # Основная модель
USE_GPT4_FOR_COMPLEX=false   # Отключить GPT-4 для сложных тем
```

### 2. Только для критически важных тем
```bash
# Включить GPT-4 только для сложных тем
USE_GPT4_FOR_COMPLEX=true
```

Сложные темы (автоматически используют GPT-4):
- травма, депрессия, тревожность
- кризис, отношения, семья
- дети, секс, любовь, развод
- потеря, психология, терапия

### 3. Оптимизация промптов
- Короткие, четкие инструкции
- Меньше примеров в промпте
- Фокус на конкретных задачах

### 4. Настройки токенов
```bash
# В коде
max_tokens=3500  # Вместо 4000 для GPT-3.5
temperature=0.7  # Вместо 0.8 для более предсказуемого результата
```

## 📈 Рекомендуемые настройки

### Бюджетный режим (до $20/месяц)
```bash
WRITING_MODEL=gpt-3.5-turbo
USE_GPT4_FOR_COMPLEX=false
MAX_ARTICLES_PER_DAY=2
```

### Сбалансированный режим (до $50/месяц)
```bash
WRITING_MODEL=gpt-3.5-turbo
USE_GPT4_FOR_COMPLEX=true
MAX_ARTICLES_PER_DAY=3
```

### Премиум режим (до $200/месяц)
```bash
WRITING_MODEL=gpt-4
USE_GPT4_FOR_COMPLEX=true
MAX_ARTICLES_PER_DAY=3
```

## 🔧 Как изменить настройки

### 1. В GitHub Secrets
Добавьте в Settings → Secrets and variables → Actions:
- `WRITING_MODEL` = `gpt-3.5-turbo`
- `USE_GPT4_FOR_COMPLEX` = `false`

### 2. В локальном .env файле
```bash
cp config.env.example .env
# Отредактируйте .env файл
```

### 3. В GitHub Actions workflow
Измените в `.github/workflows/daily-article-processor.yml`:
```yaml
- name: Create environment file
  run: |
    cat > .env << EOF
    OPENAI_API_KEY=${{ secrets.OPENAI_API_KEY }}
    WRITING_MODEL=gpt-3.5-turbo
    USE_GPT4_FOR_COMPLEX=false
    EOF
```

## 📊 Мониторинг расходов

### OpenAI Dashboard
1. Перейдите на https://platform.openai.com/usage
2. Установите лимиты расходов
3. Настройте уведомления

### Рекомендуемые лимиты
- **Дневной лимит:** $5
- **Месячный лимит:** $50
- **Уведомления:** при 80% лимита

## 🎯 Качество vs Стоимость

### GPT-3.5-turbo подходит для:
- ✅ Стандартные психологические темы
- ✅ Самопомощь и мотивация
- ✅ Общие советы по отношениям
- ✅ Простые техники релаксации

### GPT-4 нужен для:
- ⚠️ Сложные травмы и кризисы
- ⚠️ Детская психология
- ⚠️ Семейная терапия
- ⚠️ Клинические случаи

## 💡 Дополнительные советы

1. **Кэширование:** Повторное использование анализа для похожих тем
2. **Батчинг:** Обработка нескольких статей за один запрос
3. **Оптимизация промптов:** Уменьшение длины промптов
4. **Фильтрация:** Более строгий отбор статей для обработки

## 🚨 Экстренная экономия

Если расходы превышают бюджет:
```bash
# Временно отключить генерацию
MAX_ARTICLES_PER_DAY=0

# Или перейти на минимальный режим
MAX_ARTICLES_PER_DAY=1
WRITING_MODEL=gpt-3.5-turbo
USE_GPT4_FOR_COMPLEX=false
```
